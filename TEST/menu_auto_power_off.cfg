 
###############################################################
#         Define LCD menu for AUTO POWER OFF 
###############################################################
#  Main
#  ...
#
#  + USER
#    + Auto power off
#        + Enable: False/True
#        + Power: ON/OFF
#  

[menu __main __user __auto_power_off]
type: list
name: Auto Power OFF



[menu __main __user __auto_power_off __enable]
type: input
name: Enable: {'True' if menu.input else 'False'}
input: {1 if printer.save_variables.variables.auto_power_off.enable else 0}
input_min: 0
input_max: 1
input_step: 1
gcode:
  {% set recovery = printer.save_variables.variables.auto_power_off %}     
  {% set _dummy = recovery.update({'enable': True if menu.input else False}) %}
  SAVE_VARIABLE VARIABLE=auto_power_off VALUE="{recovery}"
          


[menu __main __user __auto_power_off __on_off]
type: command
name: Power: {'OFF' if printer['output_pin PS_ON'].value == 1.0 else 'ON'}
gcode:

     {% if printer['output_pin PS_ON'].value == 1.0 %}
        POWER_OFF
     {% else %}
        M80
     {% endif %}
      

  
